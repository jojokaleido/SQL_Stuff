-- Notes from MVA SQL Database Fundamentals


-- CREATE TABLE SCHEMA.TABLENAME
CREATE TABLE Sales.Products (ProductID INTEGER IDENTITY PRIMARY KEY, Name VARCHAR(20), Price DECIMAL NULL);


-- ADD NEW VARIABLE "SUPPLIER" AND STATE A DEFAULT IF NO INPUT DETECTED
ALTER TABLE Sales.Product
ADD Suplier INTEGER NOT NULL CONSTRAINT def_supplier DEFAULT 1;

-- ADD DATA POINT (ORDER MATTERS FOR VARIABLE ENTRY)
INSERT INTO Product
VALUES ('Widget', 12.99,1);

-- RETREIVE SPECIFIC VARIABLES FROM DATA
SELECT ProductID, Name, Price FROM Product;

-- RETRIEVE DATA, RENAME VARIABLE, TAKE 10% OFF PRICE, WITH CONDITIONAL SUPPLIER FILTER
SELECT Name AS Product, Price * 0.9 AS SalePrice FROM Product WHERE Supplier =2;

---------

CREATE TABLE dbo.Customer
(CustomerID INTEGER IDENTITY PRIMARY KEY,
FirstName NVARCAR(20) NOT NULL,
MiddleName (20) NULL,
LastName NVARCHAR(20) NULL,
AcountOpened DATA DEFAULT GETDATE(),
CreditLimit DECIMAL(6.2) DEFAULT 1000.00);

INSERT INTO dbo.Customer
VALUES ('Danny', 'D', 'Day', '1/1/2018', 500.00);


-- DEFINE DEFAULTS & NULLS
INSERT INTO dbo.Customer
VALUES ('Rob', NULL, 'Romano', DEFAULT, DEFAULT);

-- INSERT INTO SPECIFIC VARS
INSERT INTO dbo.Customer (FirstName, LastName)
VALUES ('Jimmy', 'Thomas';

-- CONCATENATE NEW VAR FROM 2 EXISTING VARS, CALCULATE THE # OF DAYS SINCE ACCOUNT OPENED 
SELECT CustomerID, FirstName + ' ' + LastName AS FullName,
DATEDIFF(dd, AccountOpened, GETDATE()) AS AccountDays 
FROM dbo.Customer;

